<html>
<head>
<meta charset=utf-8>
<title>nico</title>
<script src="nico.js"></script>
<script>
let player1 = document.getElementById('NicoPlayer');
    player1.contentWindow.postMessage({
        sourceConnectorType: 1,
        eventName: 'play'
    }, 'http://embed.nicovideo.jp');

    window.addEventListener('message', (e) => {
        if (e.origin === 'http://embed.nicovideo.jp') {
            console.log(e.data.eventName);
        }
    });
</script>
</head>
<body>
<div class="NicoPlayer" id="NicoPlayer"></div>
<script>
function removeNicoPlayer(){
    var np=document.getElementsByClassName('NicoPlayer');
    //子要素を全て削除
    var i = 0;
    while(np.length > i){
      n = np[i];
      while (n.firstChild !== null){
        n.removeChild(n.firstChild);
      }
      n.parentNode.removeChild(n);
      i++;
		}
	//    while (np.firstChild != null){
	//      np.removeChild(np.firstChild);
	//    }
	//自分を削除
	//    np.parentNode.removeChild(np);
}
var nico=null;
function loadVideo(id) {
  loopCountN=0;
  var frame_loaded=document.getElementById("frame_loaded");
  frame_loaded.innerHTML="";
	removeNicoPlayer();
	nico=new NicovideoPlayer('body',id);
}
function mySeekTo(point) {
	nico.postMessage({
	    eventName: 'seek',
	    data: {
	      time: point } });
}
function myPauseVideo() {
	nico.postMessage({
        eventName: 'pause',
    });
}
function myPlayVideo() {
  loopCountN=0;
		//alert('再生');
	nico.postMessage({
        sourceConnectorType: 1,
        eventName: 'play',
    });
}
function myIsMuted(){
  return isMute;
}
function myGetVolume() {
	return VolumeData;
}
function mySetVolume(vol) {
	nico.postMessage({
        eventName: 'volumeChange',
        data: {
          volume: vol/100 } });
	VolumeData=vol;
}
function myMute() {
	nico.postMessage({
        eventName: 'mute',
        data: {
          mute: true } });
}
function myUnMute() {
	nico.postMessage({
        eventName: 'mute',
        data: {
          mute: false } });
}
function myGetTitle(){
	return "NotSuport";
}
function alertLoopCount(){
	alert("LC="+loopCountN);
}
</script>
<h1 id="frame_loaded">ニコニコ動画表示iframe読み込み完了</h1>
<!--
	<div style="margin-bottom: 5px;">
		<input type="button" name="btn4" value="音量を設定(setVolume)"
			onclick="mySetVolume(30);" /><input type="button" name="btn5"
			value="音量を取得(getVolume)" onclick="myGetVolume();" />
	</div>
	<div style="margin-bottom: 5px;">
		<input type="button" name="btn1" value="再生(playVideo)"
			onclick="myPlayVideo();" /> <input type="button" name="btn2"
			value="一時停止(pauseVideo)" onclick="myPauseVideo();" />
  </div>
-->
</body>
</html>